{extend name="public/container"}{block name="head_top"}<link rel="stylesheet" href="{__PLUG_PATH}formselects/formSelects-v4.css"><script src="{__PLUG_PATH}formselects/formSelects-v4.min.js"></script><script src="{__PLUG_PATH}sweetalert2/sweetalert2.all.min.js"></script>{/block}{block name="content"}<div class="row">    <div class="col-sm-12">        <div class="ibox">            <div class="ibox-content">                <form class="layui-form" action="" style="padding:20px;">                    <fieldset><legend><a name="input">通过搜索昵称、UID、手机号快速选择用户</a></legend></fieldset>                    <select name="uids" id="bind_select" xm-select="user_select" xm-select-search="{:Url('find_users')}" xm-select-radio>                        <option value="">请选择绑定用户</option>                    </select>                    <br/>                    <button class="btn btn-primary" id="save" type="button">                        <i class="fa  fa-arrow-circle-o-right"></i>                        绑定用户                    </button>                </form>            </div>        </div>    </div></div>{/block}{block name="script"}<script src="{__FRAME_PATH}js/toast-js.js"></script><script>  var formSelects = layui.formSelects;  $.ajax({    url:"{:Url('get_user')}",    data:{},    type:'get',    dataType:'json',    success:function(res){      if(res.code == 200){        var selectHtml = '<option value='+res.data.uid+' selected>'+res.data.nickname+'</option>';        if(res.data){          $("#bind_select").append(selectHtml);          var form = layui.form;          form.render();          formSelects.config('user_select', {            type: 'get',                //请求方式: post, get, put, delete...            searchName: 'nickname',      //自定义搜索内容的key值            clearInput: true,          //当有搜索内容时, 点击选项是否清空搜索内容, 默认不清空          }, false);        }      }else{        Toast.error(res.msg);      }    }  });  $('#save').on('click',function(){    var selectVal = formSelects.value('user_select', 'val')[0];    var selectName = formSelects.value('user_select', 'name')[0];    $.ajax({      url:"{:Url('bind_user')}",      data:{        uid:selectVal      },      type:'post',      dataType:'json',      success:function(res){        if(res.code == 200){          Toast.success(res.msg);          window.localStorage.setItem("bind_username",selectName);          window.localStorage.setItem("bind_userId",selectVal);          setTimeout(function (e) {            parent.layer.close(parent.layer.getFrameIndex(window.name));          },600)        }else{          Toast.error(res.msg);        }      }    });  });</script>{/block}